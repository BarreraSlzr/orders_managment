# ─── Authentication & Authorization ───────────────────────────────────────────
# Secret used to sign session cookies (min 32 chars, generate with: openssl rand -hex 32)
AUTH_SECRET=

# Session cookie name (shared across services for cross-service SSO)
AUTH_COOKIE_NAME=__session

# Session TTL in seconds (default: 7 days)
AUTH_SESSION_TTL=604800

# Comma-separated list of allowed origins for cross-service cookie sharing
# Example: https://orders.example.com,https://inventory.example.com
AUTH_ALLOWED_ORIGINS=https://orders.internetfriends.xyz,https://session.internetfriends.xyz

# Cookie domain for cross-service sharing (e.g. .example.com)
# Leave empty for single-domain deployments.
AUTH_COOKIE_DOMAIN=

# ─── Admin Query Prompt ──────────────────────────────────────────────────────
# Password required for admin prompt validation
ADMIN_PASSWORD=

# Shared API key set as a cross-domain cookie after validation
ADMIN_SHARED_API_KEY=

# Cookie name for the shared API key
ADMIN_API_KEY_COOKIE=__admin_api_key

# ─── Database ─────────────────────────────────────────────────────────────────
POSTGRES_URL=

# ─── MercadoPago Configuration ──────────────────────────────────────────────
# Required for the "Connect with MercadoPago" OAuth flow and webhook events.
# Get APP credentials from https://www.mercadopago.com.mx/developers/panel/app

# ─── OAuth ───────────────────────────────────────────────────────────────────

# Your MercadoPago application client ID
MP_CLIENT_ID=

# Your MercadoPago application client secret (keep secret!)
MP_CLIENT_SECRET=

# OAuth callback path (relative — resolved at runtime with the app origin).
# Shared endpoint pattern (recommended): use the same URL as production webhook.
# Local:      http://localhost:3000/api/mercadopago/webhook
# Production: https://orders.internetfriends.xyz/api/mercadopago/webhook
MP_REDIRECT_URI=/api/mercadopago/webhook

# ─── Webhooks ────────────────────────────────────────────────────────────────
# Configure these URLs in the MercadoPago dashboard → Webhooks.
#
# Production URL:
#   https://orders.internetfriends.xyz/api/mercadopago/webhook
# Test / sandbox URL:
#   https://orders.internetfriends.xyz/api/mercadopago/webhook/test
#
# For sandbox-only tests you can temporarily point MP test notifications to:
#   https://orders.internetfriends.xyz/api/mercadopago/webhook/test
MP_REDIRECT_TEST_URI=/api/mercadopago/webhook/test

# Secret key for x-signature HMAC validation (assigned by MercadoPago when
# you create a webhook configuration).  If empty, signature validation is
# skipped — only acceptable during local development.
MP_WEBHOOK_SECRET=

# Optional dedicated key for MercadoPago access/refresh token encryption-at-rest.
# If omitted, AUTH_SECRET is used as fallback for encryption/decryption.
# Recommended: set a distinct 32+ char secret in production.
MP_TOKENS_ENCRYPTION_KEY=

# ─── Feature flags ────────────────────────────────────────────────────────────

# ─── Platform billing webhook ────────────────────────────────────────────────
# Secret for HMAC validation of subscription lifecycle webhooks from the
# platform billing provider.  This is a DIFFERENT key from MP_WEBHOOK_SECRET:
#
#   MP_WEBHOOK_SECRET         — used by /api/mercadopago/webhook
#                               bound to the marketplace/aggregator app
#                               (validates per-tenant payment events)
#
#   MP_BILLING_WEBHOOK_SECRET — used by /api/billing/mercadopago/webhook
#                               bound to the platform subscription billing app
#                               (validates subscription lifecycle events)
#
# When empty, signature validation is skipped (dev only).
MP_BILLING_WEBHOOK_SECRET=

# ─── Feature flags ────────────────────────────────────────────────────────────

# Set to "true" to enable the entitlement soft-gate for Mercado Pago features.
# When "false" (default) all tenants bypass the check so existing deployments
# are unaffected until the billing infrastructure (tenant_subscriptions) is wired.
ENTITLEMENT_ENABLED=false